# План безпечного впровадження (по етапах)

Мета: запровадити якість **без поломок** і “фальшпозитивів”, починаючи в режимі спостереження (*observe-only*) і лише потім — плавно посилюючи вимоги.

## Етап 1 — Observe‑only (без блокувань)
- Додаємо конфіги якості (`.ruff.toml`, `.isort.cfg`, `.pre-commit-config.yaml`, `requirements-dev.txt`).
- У CI (за наявності) — окремий job **quality-dry-run** з `exit 0` (звіт без фейлу).
- Налаштовуємо виключення аналізу (`dev/tmp`, артефакти, кеші), щоб прибрати шум.

## Етап 2 — Швидкі виправлення (low‑hanging fruit)
- Невеликі PR: форматування, зайві імпорти, очевидні стилістичні помилки.
- Вмикаємо частину правил для **нового/зміненого** коду; старе не чіпаємо.

## Етап 3 — Стабілізація тестів
- Додаємо таймаути й ретраї (backoff+джитер) для нестабільних місць.
- Синтетичні дані за замовчуванням; мережеві/повільні тести позначаємо маркерами/скипаємо в smoke.
- Встановлюємо цільове покриття для **зміненого** коду (наприклад, ≥ 85%).

## Етап 4 — М’яке посилення
- Робимо quality‑перевірки частково обов’язковими: фейлить CI лише **нові порушення** у змінених файлах.
- `pre-commit` — спершу опційний (manual), далі — обов’язковий на ключових гілках.

## Етап 5 — Стале утримання якості
- DoD стає нормою: збірка, тести, доки, лінтери, артефакти.
- Періодичні “quality‑sweep” PR для накопичених боргів (без ризиків).
- Оновлення інструментів — лише з changelog‑перевіркою та в окремих PR.

### Запобіжники
- **Kill‑switch** у CI для якості на перших ітераціях.
- **Винятки** лише з причиною/таймбоксом і фіксацією в IRM.
- **Бекапи** перед міграціями й чітке розділення dev/prod конфігів.
